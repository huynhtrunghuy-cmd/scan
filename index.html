<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>QuÃ©t BARCODE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://unpkg.com/html5-qrcode"></script>

  <style>
    body { margin:0; background:black; color:#0f0; font-family:Arial }
    #reader { width:100vw; height:80vh }
    #msg {
      position:fixed; bottom:60px; width:100%;
      text-align:center; background:rgba(0,0,0,.7); padding:8px
    }
    #btn {
      position:fixed; bottom:10px; left:50%;
      transform:translateX(-50%);
      padding:12px 20px;
      font-size:16px;
    }
  </style>
</head>

<body>

<div id="reader"></div>
<div id="msg">ğŸ‘‰ Báº¥m nÃºt Ä‘á»ƒ báº¯t Ä‘áº§u quÃ©t</div>
<button id="btn">â–¶ï¸ Báº®T Äáº¦U QUÃ‰T</button>

<script>
  const msg = document.getElementById("msg");
  const btn = document.getElementById("btn");
  let lock = false;
  let scanner;

  btn.onclick = async () => {
    btn.disabled = true;
    msg.innerText = "ğŸ“· ÄÆ°a BARCODE vÃ o camera";

    scanner = new Html5Qrcode("reader");
    const cameras = await Html5Qrcode.getCameras();
    if (!cameras.length) {
      msg.innerText = "âŒ KhÃ´ng cÃ³ camera";
      return;
    }

    scanner.start(
      cameras[0].id,
      {
        fps: 10,
        qrbox: { width: 320, height: 160 },
        formatsToSupport: [
          Html5QrcodeSupportedFormats.EAN_13,
          Html5QrcodeSupportedFormats.CODE_128,
          Html5QrcodeSupportedFormats.CODE_39,
          Html5QrcodeSupportedFormats.UPC_A
        ]
      },
      (text) => {
        if (lock) return;
        lock = true;

        msg.innerText = "âœ… ÄÃ£ quÃ©t: " + text;

        fetch("https://script.google.com/macros/s/AKfycbz9r9d2kdLL0npdPFuEd-tzq03mlM1Pps0hYKKlELCmaDHvjTERD871noMJKGaKCx5kHA/exec", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: "barcode=" + encodeURIComponent(text)
        });

        navigator.vibrate?.(100);

        setTimeout(() => {
          lock = false;
          msg.innerText = "ğŸ“· ÄÆ°a BARCODE vÃ o camera";
        }, 1200);
      }
    );
  };
</script>

</body>
</html>
