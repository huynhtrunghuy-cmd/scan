<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Qu√©t BARCODE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://unpkg.com/html5-qrcode"></script>

  <style>
    body {
      margin: 0;
      background: black;
      color: #0f0;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    #reader {
      width: 100vw;
      height: 100vh;
    }
    #msg {
      position: fixed;
      bottom: 10px;
      width: 100%;
      background: rgba(0,0,0,0.7);
      padding: 8px 0;
      font-size: 16px;
    }
  </style>
</head>

<body>

<div id="reader"></div>
<div id="msg">üì¶ ƒê∆∞a BARCODE v√†o camera</div>

<script>
  const msg = document.getElementById("msg");
  let lock = false;

  function onScanSuccess(text, result) {
    if (lock) return;
    lock = true;

    msg.innerText = "‚úÖ ƒê√£ qu√©t: " + text;

    fetch("https://script.google.com/macros/s/AKfycbz9r9d2kdLL0npdPFuEd-tzq03mlM1Pps0hYKKlELCmaDHvjTERD871noMJKGaKCx5kHA/exec", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: "barcode=" + encodeURIComponent(text)
    });

    navigator.vibrate?.(100);

    setTimeout(() => {
      lock = false;
      msg.innerText = "üì¶ ƒê∆∞a BARCODE v√†o camera";
    }, 1200);
  }

  const html5QrCode = new Html5Qrcode("reader");

  Html5Qrcode.getCameras().then(cameras => {
    if (!cameras.length) {
      msg.innerText = "‚ùå Kh√¥ng t√¨m th·∫•y camera";
      return;
    }

    html5QrCode.start(
      cameras[0].id,
      {
        fps: 10,
        qrbox: { width: 300, height: 150 },
        formatsToSupport: [
          Html5QrcodeSupportedFormats.CODE_128,
          Html5QrcodeSupportedFormats.CODE_39,
          Html5QrcodeSupportedFormats.EAN_13,
          Html5QrcodeSupportedFormats.EAN_8,
          Html5QrcodeSupportedFormats.UPC_A,
